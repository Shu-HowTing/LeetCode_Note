## 二分查找

> **思路很简单，细节是魔鬼。** -- Knuth

### 区间端点

```python
left = 0
right = len(nums)
```

如果如此初始化，则搜寻的区间是一个左开右闭的$[left,\ right)$。在接下来对left和right的更新中也要保持左开右闭：

```python
right = mid
or
left = mid + 1
```

如果查找的是左边界，则在$nums[mid] == target$，需要继续移动$right$:

```python
# 返回第一个不小于target的元素的下标(左边界)
#  [1, 2, 3, 3, 3, 5, 6]             
#         ^
def binsearch4(nums, target):
    left, right = 0, len(nums)
    while left < right:
        mid = (right + left) // 2
        if target <= nums[mid]:
            right = mid
        else:
            left = mid + 1
    return left
```

如果查找的是右边界，则在$nums[mid] == target$，需要继续移动$left$

```python
# 版本3
# 返回不大于target的最后一个元素的下标(右边界)
#  [1, 2, 3, 3, 3, 5, 6]             
#               ^
def binsearch3(nums, target):
    left, right = 0, len(nums)
    # 因为right = len(nums), 所以对应的查找区间为[left, right), 左闭右开
    # 所以退出循环的时候应该是left = right, 所以使用 < 
    while left < right:
        mid = (left + right) >> 1
        if target < nums[mid]:
            right = mid
        # 因为要返回右边界，所以找到不着急停止，继续往右边区间找
        elif target >= nums[mid]:
            left = mid + 1
    left -= 1
    return left
```

查找旋转数组的旋转点：

```python
# 搜索旋转数组的旋转点
# [5, 6, 7, 2, 3, 4]  # 2
#           ^
def binsearch5(nums):
    left, right = 0, len(nums)
    while left < right:
        mid = (left + right) // 2
        if nums[mid] >= nums[0]:
            left = mid + 1
        else:
            right = mid
    return nums[left] if left < len(nums) else nums[0]
```

 在旋转数组里查找$target$

```python
# 整数数组 nums 按升序排列，数组中的值 互不相同
def search(self, nums, target):
    if not nums:
        return -1
    left, right = 0, len(nums)
    while left < right:
        mid = left + (right - left ) // 2
        if nums[mid] == target:
            return mid
        # 左半段有序
        if nums[mid] >= nums[left]:
            # 仅凭target < nums[mid]是无法确定下一个查找区间的
            if nums[left] <= target < nums[mid]:
                right = mid
            else:
                left = mid + 1
        # 右半段有序
        else:
            if nums[mid] < target <= nums[right-1]:
                left = mid + 1
            else:
                right = mid
    return -1
```
